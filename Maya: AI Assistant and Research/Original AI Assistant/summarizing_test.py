from transformers import AutoModelForQuestionAnswering, AutoTokenizer, pipeline, AutoModelForSeq2SeqLM
model_name = "facebook/bart-large-cnn"
model = AutoModelForSeq2SeqLM.from_pretrained(model_name)
tokenizer = AutoTokenizer.from_pretrained(model_name)
# a) Get predictions
ctx = 'You wouldnt have heard of me unless youve read a book called The Adventures of Tom Sawyer. But thats okay. Mr. Mark Twain wrote that book, and what he wrote was mostly true. He exaggerated some things, but most of it was true. Thats not a big deal. I never met anybody who hasnt lied at one time or another, except for maybe Aunt Polly, the widow, or Mary. Aunt Polly—Toms Aunt Polly, that is—and Mary and the Widow Douglas are all in that book, which was mostly true, except for some exaggerations, as I said before. Now at the end of that book, Tom and I had found the money that the robbers hid in the cave. That money made us rich. We got six thousand dollars each, all in gold. It looked awesome when it was all piled up. Well, Judge Thatcher took that money and invested it. It earned each of us a dollar a day for every day of the year, which was more money than we knew what to do with. The Widow Douglas adopted me and said shed teach me manners, but it was really hard for me to livein her house because she was so prim and proper. When I couldnt stand it any longer, I ran away. I put on my old ratty clothes and hung out in my favorite sugar barrel. I was happy and free again. But then Tom Sawyer found me. He said he was forming a band of robbers and that I could join if I returned to the widows house and acted respectably. So I went back. The widow cried when I came back. She called me a poor lost lamb and a lot of other names, but she didnt mean any harm. She made me wear those new clothes, which made me sweat and feel cooped up all over again. Then all the fuss over rules started up again. For example, whenever the widow rang the supper bell, you had to drop what you were doing and come to the table. When you sat down to eat, you had to wait for her to bow her head and pray, even though there wasnt anything wrong with the food—except for the fact that she separated everything on the plate, which doesnt make the food taste as good as it does when it gets jumbled together and the flavors mix. After supper she got out her Bible and taught me all about Moses and the Bulrushers . I was pretty excited to hear about him, until she told me that hed been dead a long time. After that, I didnt really care to hear more, since Im not interested in dead people. Pretty soon, I wanted a smoke, and I asked the widow if that would be okay, but she said no. She said that smoking was filthy and disgusting, and that I had to stop. Thats just the way it is with some people—they badmouth things they dont know anything about. Here she was going on and on about Moses, who wasnt related to her and couldnt help anybody since hes dead. But then she picks on me for trying to do something that would have done me some good. And she even takes snuff. Of course, she thought that was okay because it was something she liked to do.'
summarizer = pipeline("summarization", model=model, tokenizer=tokenizer)
summary = summarizer(ctx, max_length=400, min_length=20, do_sample=False)
print(summary[0]['summary_text'])